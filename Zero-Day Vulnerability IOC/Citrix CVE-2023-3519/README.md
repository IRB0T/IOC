## CVE-2023-3519 || Unauthenticated Remote Code Execution (RCE) vulnerability affecting NetScaler (formerly Citrix) Application Delivery Controller (ADC) and NetScaler Gateway 

<br>#CVE-2023-3519
<br>#NetScaler (formerly Citrix)

" an unauthenticated remote code execution (RCE) vulnerability affecting NetScaler (formerly Citrix) Application Delivery Controller (ADC) and NetScaler Gateway."

| S.No | Indicator            | Type   | Comment |
|:-----:|:----------------|:---------|:--------------------|
|1 | Check following keywords in Log files. "pwd;pwd;pwd;pwd;pwd;" used within the exploit POST requests   |Logs|--|
|2 | Check for files newer than the last installation  | Files&Folders  | |
|3 | Check http error logs for abnormalities that may be from initial exploit:   | Logs  | grep '\\.sh' \/var\/log\/httperror.log\*  |
|4 | Check shell logs for unusual post-ex commands  | Logs  |  |
|5 | Review network and firewall logs for subnet-wide scanning of HTTP/HTTPS/SMB (80/443/445) originating from the ADC  | Logs  |  |
|6 | Review NetScaler ADC internal logs (sh.log\*, bash.log\*)   | Logs  | Keywords: database.php,ns_gui\/vpn,\/flash\/nsconfig\/keys\/updated |


<br>
Check for Following Directories and sub-directories for the presence of web-shell
<ul>
<li>\\var\\vpn\\</li>
<li>\\var\\netscaler\\logon\\</li>
<li>\\var\\python\\</li>
<li>\\netscaler\\ns_gui\\</li>
<li>\\tmp\\</li>
</ul>


Affected Versions (NetScaler ADC and NetScaler Gateway):
<ul>
<li>NetScaler ADC and NetScaler Gateway 13.1 before 13.1-49.13</li>
<li>NetScaler ADC and NetScaler Gateway 13.0 before 13.0-91.13</li>
<li>NetScaler ADC and NetScaler Gateway version 12.1, now end of life</li>
<li>NetScaler ADC 13.1-FIPS before 13.1-37.159</li>
<li>NetScaler ADC 12.1-FIPS before 12.1-65.36</li>
<li>NetScaler ADC 12.1-NDcPP before 12.65.36</li>
</ul>

Reference:
<br>1.https://www.cisa.gov/sites/default/files/2023-07/aa23-201a_csa_threat_actors_exploiting_citrix-cve-2023-3519_to_implant_webshells.pdf
